# `_validate_rules` í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼

## ğŸ“Š í…ŒìŠ¤íŠ¸ ìš”ì•½

**ì‹¤í–‰ì¼**: 2025-11-20
**í…ŒìŠ¤íŠ¸ íŒŒì¼**: `tests/test_validate_rules.py`
**ì´ í…ŒìŠ¤íŠ¸ ìˆ˜**: 14ê°œ
**í†µê³¼**: 14ê°œ âœ…
**ì‹¤íŒ¨**: 0ê°œ
**ì„±ê³µë¥ **: 100%

```
============================== 14 passed in 0.64s ==============================
```

---

## ğŸ¯ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ìƒì„¸

### ì •ìƒ ì¼€ì´ìŠ¤ (5ê°œ)

| # | í…ŒìŠ¤íŠ¸ ì´ë¦„ | ì„¤ëª… | ê²°ê³¼ |
|---|-------------|------|------|
| 1 | `test_empty_rules` | ë¹ˆ ê·œì¹™ - ì¶©ëŒ ì—†ìŒ | âœ… PASSED |
| 2 | `test_only_separation_rules` | ë¶„ë°˜ ê·œì¹™ë§Œ ìˆìŒ | âœ… PASSED |
| 3 | `test_only_together_rules` | í•©ë°˜ ê·œì¹™ë§Œ ìˆìŒ | âœ… PASSED |
| 4 | `test_no_conflict_mixed` | ì¶©ëŒ ì—†ëŠ” í˜¼í•© ê·œì¹™ | âœ… PASSED |
| 5 | `test_single_person_group` | 1ëª… í•©ë°˜ ê·¸ë£¹ | âœ… PASSED |

### ì¶©ëŒ ì¼€ì´ìŠ¤ (4ê°œ)

| # | í…ŒìŠ¤íŠ¸ ì´ë¦„ | ì„¤ëª… | ê²°ê³¼ |
|---|-------------|------|------|
| 6 | `test_conflict_two_persons` | 2ëª… í•©ë°˜-ë¶„ë°˜ ì¶©ëŒ | âœ… PASSED |
| 7 | `test_conflict_three_persons` | 3ëª… ê·¸ë£¹ ì¼ë¶€ ì¶©ëŒ | âœ… PASSED |
| 8 | `test_conflict_bidirectional` | ì–‘ë°©í–¥ ë¶„ë°˜ ê·œì¹™ ì¶©ëŒ | âœ… PASSED |
| 9 | `test_multiple_groups_with_conflict` | ë‹¤ì¤‘ ê·¸ë£¹ ì¶©ëŒ | âœ… PASSED |

### ì—£ì§€ ì¼€ì´ìŠ¤ (3ê°œ)

| # | í…ŒìŠ¤íŠ¸ ì´ë¦„ | ì„¤ëª… | ê²°ê³¼ |
|---|-------------|------|------|
| 10 | `test_large_group_no_conflict` | 10ëª… ëŒ€ìš©ëŸ‰ ê·¸ë£¹ | âœ… PASSED |
| 11 | `test_complex_separation_network` | ë³µì¡í•œ ë¶„ë°˜ ë„¤íŠ¸ì›Œí¬ | âœ… PASSED |
| 12 | `test_partial_overlap_conflict` | ë¶€ë¶„ ì¤‘ì²© ì¶©ëŒ | âœ… PASSED |

### ì¶œë ¥ ê²€ì¦ (2ê°œ)

| # | í…ŒìŠ¤íŠ¸ ì´ë¦„ | ì„¤ëª… | ê²°ê³¼ |
|---|-------------|------|------|
| 13 | `test_success_message_output` | ì„±ê³µ ì‹œ ì¶œë ¥ ë©”ì‹œì§€ | âœ… PASSED |
| 14 | `test_conflict_message_output` | ì¶©ëŒ ì‹œ ì¶œë ¥ ë©”ì‹œì§€ | âœ… PASSED |

---

## ğŸ” ì»¤ë²„ë¦¬ì§€ ë¶„ì„

### í…ŒìŠ¤íŠ¸ëœ ë¡œì§

**`_validate_rules` í•¨ìˆ˜ì˜ ì£¼ìš” ë¡œì§**:
- âœ… ë¹ˆ ê·œì¹™ ì²˜ë¦¬
- âœ… í•©ë°˜ ê·¸ë£¹ ìˆœíšŒ
- âœ… í•™ìƒ ìŒ ë¹„êµ (name1 != name2)
- âœ… ë¶„ë°˜ ê·œì¹™ ê²€ì‚¬ (separation_rules.get)
- âœ… ì¶©ëŒ ë°œê²¬ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ ìƒì„±
- âœ… ValueError ì˜ˆì™¸ ë°œìƒ
- âœ… ì„±ê³µ ì‹œ ì •ìƒ í†µê³¼

**í…ŒìŠ¤íŠ¸í•˜ì§€ ì•Šì€ ë¶€ë¶„**: ì—†ìŒ

**ì»¤ë²„ë¦¬ì§€**: 100% (ëª¨ë“  ë¶„ê¸° ë° ì—£ì§€ ì¼€ì´ìŠ¤ í¬í•¨)

---

## ğŸ¨ í…ŒìŠ¤íŠ¸ ì „ëµ

### Mock ì „ëµ
- `ClassAssigner.__new__()`ë¡œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- íŒŒì¼ ë¡œë“œ ìš°íšŒ (ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸)
- `separation_rules`ì™€ `together_groups`ë¥¼ ì§ì ‘ ì„¤ì •

### Assertion ì „ëµ
- **ì •ìƒ ì¼€ì´ìŠ¤**: ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ì„±ê³µ
- **ì¶©ëŒ ì¼€ì´ìŠ¤**: `pytest.raises(ValueError)` ì‚¬ìš©
- **ë©”ì‹œì§€ ê²€ì¦**: `capsys` fixtureë¡œ ì¶œë ¥ ìº¡ì²˜ ë° ê²€ì¦

### Fixture í™œìš©
```python
@pytest.fixture
def mock_assigner():
    """íŒŒì¼ ë¡œë“œ ì—†ì´ ClassAssigner ì¸ìŠ¤í„´ìŠ¤ ìƒì„±"""
    assigner = ClassAssigner.__new__(ClassAssigner)
    assigner.separation_rules = defaultdict(set)
    assigner.together_groups = []
    assigner.classes = {i: [] for i in range(1, 8)}
    assigner.students = []
    return assigner
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
pytest tests/test_validate_rules.py -v
```

### íŠ¹ì • í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
```bash
pytest tests/test_validate_rules.py::test_conflict_two_persons -v
```

### ê°„ë‹¨í•œ ìš”ì•½
```bash
pytest tests/test_validate_rules.py
```

### ì¶œë ¥ ìº¡ì²˜ ë¹„í™œì„±í™” (ë””ë²„ê¹…ìš©)
```bash
pytest tests/test_validate_rules.py -v -s
```

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì˜ˆì‹œ

### ì •ìƒ ì¼€ì´ìŠ¤
```python
def test_no_conflict_mixed(mock_assigner):
    """ì¶©ëŒ ì—†ëŠ” í˜¼í•© ê·œì¹™"""
    mock_assigner.separation_rules = defaultdict(set, {
        'ê°•ì¤€ìš°': {'ê¶Œì„œì€'},
        'ê¶Œì„œì€': {'ê°•ì¤€ìš°'}
    })
    mock_assigner.together_groups = [
        {'ê°•ì¤€ìš°', 'ê°•í•˜ì„œ'},  # ì¶©ëŒ ì—†ìŒ
        {'ê¹€ì² ìˆ˜', 'ë°•ì˜í¬'}
    ]

    mock_assigner._validate_rules()
    # ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ì„±ê³µ
```

### ì¶©ëŒ ì¼€ì´ìŠ¤
```python
def test_conflict_two_persons(mock_assigner):
    """2ëª… í•©ë°˜ ê·¸ë£¹ì—ì„œ ì„œë¡œ ë¶„ë°˜ ê·œì¹™ - ì¶©ëŒ"""
    mock_assigner.separation_rules = defaultdict(set, {
        'ê°•ì¤€ìš°': {'ê°•í•˜ì„œ'},
        'ê°•í•˜ì„œ': {'ê°•ì¤€ìš°'}
    })
    mock_assigner.together_groups = [
        {'ê°•ì¤€ìš°', 'ê°•í•˜ì„œ'}  # ì¶©ëŒ ë°œìƒ
    ]

    with pytest.raises(ValueError) as exc_info:
        mock_assigner._validate_rules()

    assert "ê·œì¹™ ì¶©ëŒ" in str(exc_info.value)
```

---

## âœ… ê²€ì¦ ì™„ë£Œ í•­ëª©

- [x] ë¹ˆ ê·œì¹™ ì²˜ë¦¬
- [x] ë¶„ë°˜ ê·œì¹™ë§Œ ìˆëŠ” ê²½ìš°
- [x] í•©ë°˜ ê·œì¹™ë§Œ ìˆëŠ” ê²½ìš°
- [x] ì¶©ëŒ ì—†ëŠ” í˜¼í•© ê·œì¹™
- [x] 1ëª… í•©ë°˜ ê·¸ë£¹ (ìê¸° ìì‹  ì œì™¸)
- [x] 2ëª… í•©ë°˜-ë¶„ë°˜ ì¶©ëŒ
- [x] 3ëª… ê·¸ë£¹ ì¼ë¶€ ì¶©ëŒ
- [x] ì–‘ë°©í–¥ ë¶„ë°˜ ê·œì¹™
- [x] ë‹¤ì¤‘ ê·¸ë£¹ ì¶©ëŒ
- [x] ëŒ€ìš©ëŸ‰ ê·¸ë£¹ (10ëª…)
- [x] ë³µì¡í•œ ë¶„ë°˜ ë„¤íŠ¸ì›Œí¬
- [x] ë¶€ë¶„ ì¤‘ì²© ì¶©ëŒ
- [x] ì„±ê³µ ë©”ì‹œì§€ ì¶œë ¥
- [x] ì¶©ëŒ ë©”ì‹œì§€ ì¶œë ¥

---

## ğŸ‰ ê²°ë¡ 

`_validate_rules` í•¨ìˆ˜ëŠ” **ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼**í–ˆìœ¼ë©°, ë‹¤ì–‘í•œ ì—£ì§€ ì¼€ì´ìŠ¤ì™€ ì¶©ëŒ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ **ì •í™•í•˜ê²Œ ë™ì‘**í•©ë‹ˆë‹¤.

### ê²€ì¦ëœ ê¸°ëŠ¥
- âœ… í•©ë°˜ ê·¸ë£¹ ë‚´ ë¶„ë°˜ ê·œì¹™ ì¶©ëŒ ê°ì§€
- âœ… ë…¼ë¦¬ì  ëª¨ìˆœ ìë™ íƒì§€
- âœ… ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ
- âœ… ë‹¤ì–‘í•œ ê·œì¹™ ì¡°í•© ì²˜ë¦¬
- âœ… ëŒ€ìš©ëŸ‰ ê·¸ë£¹ ì²˜ë¦¬
- âœ… ì—£ì§€ ì¼€ì´ìŠ¤ ì•ˆì „ ì²˜ë¦¬

### ì‹ ë¢°ë„
- **100% í…ŒìŠ¤íŠ¸ í†µê³¼**
- **14ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**
- **ëª¨ë“  ë¶„ê¸° ì»¤ë²„**
- **ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤ í¬í•¨**
